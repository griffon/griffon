<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AbstractMVCGroupManager.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">sample-pivot-groovy</a> &gt; <a href="index.source.html" class="el_package">org.codehaus.griffon.runtime.core.mvc</a> &gt; <span class="el_source">AbstractMVCGroupManager.java</span></div><h1>AbstractMVCGroupManager.java</h1><pre class="source lang-java linenums">/*
 * Copyright 2008-2016 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.codehaus.griffon.runtime.core.mvc;

import griffon.core.Context;
import griffon.core.ContextFactory;
import griffon.core.GriffonApplication;
import griffon.core.artifact.GriffonController;
import griffon.core.artifact.GriffonModel;
import griffon.core.artifact.GriffonMvcArtifact;
import griffon.core.artifact.GriffonView;
import griffon.core.mvc.MVCFunction;
import griffon.core.mvc.MVCGroup;
import griffon.core.mvc.MVCGroupConfiguration;
import griffon.core.mvc.MVCGroupConfigurationFactory;
import griffon.core.mvc.MVCGroupFactory;
import griffon.core.mvc.MVCGroupFunction;
import griffon.core.mvc.MVCGroupManager;
import griffon.exceptions.ArtifactNotFoundException;
import griffon.exceptions.MVCGroupConfigurationException;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import javax.annotation.Nonnull;
import javax.annotation.Nullable;
import javax.inject.Inject;
import java.util.Collections;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

import static griffon.core.GriffonExceptionHandler.sanitize;
import static griffon.util.GriffonNameUtils.isBlank;
import static griffon.util.GriffonNameUtils.requireNonBlank;
import static java.util.Arrays.asList;
import static java.util.Collections.unmodifiableMap;
import static java.util.Objects.requireNonNull;

/**
 * Base implementation of the {@code MVCGroupManager} interface.
 *
 * @author Andres Almiray
 * @since 2.0.0
 */
public abstract class AbstractMVCGroupManager implements MVCGroupManager {
    protected static final String ERROR_MVCTYPE_BLANK = &quot;Argument 'mvcType' must not be blank&quot;;
    protected static final String ERROR_MVCID_BLANK = &quot;Argument 'mvcId' must not be blank&quot;;
    protected static final String ERROR_CONFIGURATION_NULL = &quot;Argument 'configuration' must not be null&quot;;
    protected static final String ERROR_GROUP_NULL = &quot;Argument 'group' must not be null&quot;;
    protected static final String ERROR_CONFIG_NULL = &quot;Argument 'config' must not be null&quot;;
    protected static final String ERROR_ARGS_NULL = &quot;Argument 'args' must not be null&quot;;
    protected static final String ERROR_NAME_BLANK = &quot;Argument 'name' cannot be blank&quot;;
    protected static final String ERROR_TYPE_NULL = &quot;Argument 'type' cannot be null&quot;;
<span class="fc" id="L67">    private static final Logger LOG = LoggerFactory.getLogger(AbstractMVCGroupManager.class);</span>
    private final GriffonApplication application;

<span class="fc" id="L70">    private final Map&lt;String, MVCGroupConfiguration&gt; configurations = new LinkedHashMap&lt;&gt;();</span>
<span class="fc" id="L71">    private final Map&lt;String, MVCGroup&gt; groups = new LinkedHashMap&lt;&gt;();</span>
<span class="fc" id="L72">    private final Object lock = new Object[0];</span>
    private boolean initialized;

    @Inject
    private MVCGroupConfigurationFactory mvcGroupConfigurationFactory;

    @Inject
    private MVCGroupFactory mvcGroupFactory;

    @Inject
    private ContextFactory contextFactory;

    @Inject
<span class="fc" id="L85">    public AbstractMVCGroupManager(@Nonnull GriffonApplication application) {</span>
<span class="fc" id="L86">        this.application = requireNonNull(application, &quot;Argument 'application' must not be null&quot;);</span>
<span class="fc" id="L87">    }</span>

    @Override
    public GriffonApplication getApplication() {
<span class="nc" id="L91">        return application;</span>
    }

    @Nonnull
    public MVCGroupConfiguration newMVCGroupConfiguration(@Nonnull String mvcType, @Nonnull Map&lt;String, String&gt; members, @Nonnull Map&lt;String, Object&gt; config) {
<span class="fc" id="L96">        return mvcGroupConfigurationFactory.create(mvcType, members, config);</span>
    }

    @Nonnull
    public MVCGroup newMVCGroup(@Nonnull MVCGroupConfiguration configuration, @Nullable String mvcId, @Nonnull Map&lt;String, Object&gt; members, @Nullable MVCGroup parentGroup) {
<span class="nc" id="L101">        return mvcGroupFactory.create(configuration, mvcId, members, parentGroup);</span>
    }

    @Nonnull
    @Override
    public Context newContext(@Nullable MVCGroup parentGroup) {
<span class="nc bnc" id="L107" title="All 2 branches missed.">        Context parentContext = parentGroup != null ? parentGroup.getContext() : getApplication().getContext();</span>
<span class="nc" id="L108">        return contextFactory.create(parentContext);</span>
    }

    @Nonnull
    public Map&lt;String, MVCGroupConfiguration&gt; getConfigurations() {
<span class="nc" id="L113">        synchronized (lock) {</span>
<span class="nc" id="L114">            return unmodifiableMap(configurations);</span>
<span class="nc" id="L115">        }</span>
    }

    @Nonnull
    public Map&lt;String, MVCGroup&gt; getGroups() {
<span class="fc" id="L120">        synchronized (lock) {</span>
<span class="fc" id="L121">            return unmodifiableMap(groups);</span>
<span class="nc" id="L122">        }</span>
    }

    @Nonnull
    public MVCGroupConfiguration findConfiguration(@Nonnull String mvcType) {
<span class="nc" id="L127">        requireNonBlank(mvcType, ERROR_MVCTYPE_BLANK);</span>
        MVCGroupConfiguration configuration;
<span class="nc" id="L129">        synchronized (lock) {</span>
<span class="nc" id="L130">            configuration = configurations.get(mvcType);</span>
<span class="nc" id="L131">        }</span>

<span class="nc bnc" id="L133" title="All 2 branches missed.">        if (configuration == null) {</span>
<span class="nc" id="L134">            throw new MVCGroupConfigurationException(&quot;Unknown MVC type '&quot; + mvcType + &quot;'. Known types are &quot; + configurations.keySet(), mvcType);</span>
        }
<span class="nc" id="L136">        return configuration;</span>
    }

    @Nullable
    public MVCGroup findGroup(@Nonnull String mvcId) {
<span class="nc" id="L141">        requireNonBlank(mvcId, ERROR_MVCID_BLANK);</span>
<span class="nc" id="L142">        synchronized (lock) {</span>
<span class="nc" id="L143">            LOG.debug(&quot;Searching group {}&quot;, mvcId);</span>
<span class="nc" id="L144">            return groups.get(mvcId);</span>
<span class="nc" id="L145">        }</span>
    }

    @Nullable
    public MVCGroup getAt(@Nonnull String mvcId) {
<span class="nc" id="L150">        return findGroup(mvcId);</span>
    }

    public final void initialize(@Nonnull Map&lt;String, MVCGroupConfiguration&gt; configurations) {
<span class="fc" id="L154">        requireNonNull(configurations, &quot;Argument 'configurations' must not be null&quot;);</span>
<span class="pc bpc" id="L155" title="1 of 2 branches missed.">        if (configurations.isEmpty()) return;</span>
<span class="fc" id="L156">        synchronized (lock) {</span>
<span class="pc bpc" id="L157" title="1 of 2 branches missed.">            if (!initialized) {</span>
<span class="fc" id="L158">                doInitialize(configurations);</span>
<span class="fc" id="L159">                initialized = true;</span>
            }
<span class="pc" id="L161">        }</span>
<span class="fc" id="L162">    }</span>

    public void addConfiguration(@Nonnull MVCGroupConfiguration configuration) {
<span class="fc" id="L165">        requireNonNull(configuration, ERROR_CONFIGURATION_NULL);</span>
<span class="fc" id="L166">        synchronized (lock) {</span>
<span class="pc bpc" id="L167" title="3 of 4 branches missed.">            if (initialized &amp;&amp; configurations.get(configuration.getMvcType()) != null) {</span>
<span class="nc" id="L168">                return;</span>
            }
<span class="fc" id="L170">            configurations.put(configuration.getMvcType(), configuration);</span>
<span class="pc" id="L171">        }</span>
<span class="fc" id="L172">    }</span>

    public void removeConfiguration(@Nonnull MVCGroupConfiguration configuration) {
<span class="nc" id="L175">        requireNonNull(configuration, ERROR_CONFIGURATION_NULL);</span>
<span class="nc" id="L176">        removeConfiguration(configuration.getMvcType());</span>
<span class="nc" id="L177">    }</span>

    public void removeConfiguration(@Nonnull String name) {
<span class="nc" id="L180">        requireNonBlank(name, &quot;Argument 'name' must not be blank&quot;);</span>
<span class="nc bnc" id="L181" title="All 2 branches missed.">        if (!isBlank(name)) {</span>
<span class="nc" id="L182">            synchronized (lock) {</span>
<span class="nc" id="L183">                configurations.remove(name);</span>
<span class="nc" id="L184">            }</span>
        }
<span class="nc" id="L186">    }</span>

    protected void addGroup(@Nonnull MVCGroup group) {
<span class="nc" id="L189">        requireNonNull(group, ERROR_GROUP_NULL);</span>
<span class="nc" id="L190">        synchronized (lock) {</span>
<span class="nc" id="L191">            LOG.debug(&quot;Adding group {}:{}&quot;, group.getMvcId(), group);</span>
<span class="nc" id="L192">            groups.put(group.getMvcId(), group);</span>
<span class="nc" id="L193">        }</span>
<span class="nc" id="L194">    }</span>

    protected void removeGroup(@Nonnull MVCGroup group) {
<span class="nc" id="L197">        requireNonNull(group, ERROR_GROUP_NULL);</span>
<span class="nc" id="L198">        synchronized (lock) {</span>
<span class="nc" id="L199">            LOG.debug(&quot;Removing group {}:{}&quot;, group.getMvcId(), group);</span>
<span class="nc" id="L200">            groups.remove(group.getMvcId());</span>
<span class="nc" id="L201">        }</span>
<span class="nc" id="L202">    }</span>

    @Nonnull
    public final Map&lt;String, ? extends GriffonModel&gt; getModels() {
<span class="nc" id="L206">        Map&lt;String, GriffonModel&gt; models = new LinkedHashMap&lt;&gt;();</span>
<span class="nc" id="L207">        synchronized (lock) {</span>
<span class="nc bnc" id="L208" title="All 2 branches missed.">            for (MVCGroup group : groups.values()) {</span>
<span class="nc" id="L209">                GriffonModel model = group.getModel();</span>
<span class="nc bnc" id="L210" title="All 2 branches missed.">                if (model != null) {</span>
<span class="nc" id="L211">                    models.put(group.getMvcId(), model);</span>
                }
<span class="nc" id="L213">            }</span>
<span class="nc" id="L214">        }</span>
<span class="nc" id="L215">        return unmodifiableMap(models);</span>
    }

    @Nonnull
    public final Map&lt;String, ? extends GriffonView&gt; getViews() {
<span class="nc" id="L220">        Map&lt;String, GriffonView&gt; views = new LinkedHashMap&lt;&gt;();</span>
<span class="nc" id="L221">        synchronized (lock) {</span>
<span class="nc bnc" id="L222" title="All 2 branches missed.">            for (MVCGroup group : groups.values()) {</span>
<span class="nc" id="L223">                GriffonView view = group.getView();</span>
<span class="nc bnc" id="L224" title="All 2 branches missed.">                if (view != null) {</span>
<span class="nc" id="L225">                    views.put(group.getMvcId(), view);</span>
                }
<span class="nc" id="L227">            }</span>
<span class="nc" id="L228">        }</span>
<span class="nc" id="L229">        return unmodifiableMap(views);</span>
    }

    @Nonnull
    public final Map&lt;String, ? extends GriffonController&gt; getControllers() {
<span class="nc" id="L234">        Map&lt;String, GriffonController&gt; controllers = new LinkedHashMap&lt;&gt;();</span>
<span class="nc" id="L235">        synchronized (lock) {</span>
<span class="nc bnc" id="L236" title="All 2 branches missed.">            for (MVCGroup group : groups.values()) {</span>
<span class="nc" id="L237">                GriffonController controller = group.getController();</span>
<span class="nc bnc" id="L238" title="All 2 branches missed.">                if (controller != null) {</span>
<span class="nc" id="L239">                    controllers.put(group.getMvcId(), controller);</span>
                }
<span class="nc" id="L241">            }</span>
<span class="nc" id="L242">        }</span>
<span class="nc" id="L243">        return unmodifiableMap(controllers);</span>
    }

    @Nonnull
    @Override
    public MVCGroupConfiguration cloneMVCGroupConfiguration(@Nonnull String mvcType, @Nonnull Map&lt;String, Object&gt; config) {
<span class="nc" id="L249">        requireNonBlank(mvcType, ERROR_MVCTYPE_BLANK);</span>
<span class="nc" id="L250">        requireNonNull(config, ERROR_CONFIG_NULL);</span>
<span class="nc" id="L251">        MVCGroupConfiguration configuration = findConfiguration(mvcType);</span>
<span class="nc" id="L252">        Map&lt;String, Object&gt; configCopy = new LinkedHashMap&lt;&gt;();</span>
<span class="nc" id="L253">        configCopy.putAll(configuration.getConfig());</span>
<span class="nc" id="L254">        configCopy.putAll(config);</span>
<span class="nc" id="L255">        return newMVCGroupConfiguration(mvcType, configuration.getMembers(), configCopy);</span>
    }

    @Nonnull
    protected List&lt;? extends GriffonMvcArtifact&gt; createMVC(@Nonnull MVCGroupConfiguration configuration, @Nullable String mvcId, @Nonnull Map&lt;String, Object&gt; args) {
<span class="nc" id="L260">        MVCGroup group = createMVCGroup(findConfiguration(configuration.getMvcType()), mvcId, args);</span>
<span class="nc" id="L261">        return asList(group.getModel(), group.getView(), group.getController());</span>
    }

    @SuppressWarnings(&quot;unchecked&quot;)
    protected &lt;M extends GriffonModel, V extends GriffonView, C extends GriffonController&gt; void withMVCGroup(@Nonnull MVCGroupConfiguration configuration, @Nullable String mvcId, @Nonnull Map&lt;String, Object&gt; args, @Nonnull MVCFunction&lt;M, V, C&gt; handler) {
<span class="nc" id="L266">        MVCGroup group = null;</span>
        try {
<span class="nc" id="L268">            group = createMVCGroup(configuration, mvcId, args);</span>
<span class="nc" id="L269">            handler.apply((M) group.getModel(), (V) group.getView(), (C) group.getController());</span>
        } finally {
<span class="nc" id="L271">            try {</span>
<span class="nc bnc" id="L272" title="All 4 branches missed.">                if (group != null) {</span>
<span class="nc" id="L273">                    destroyMVCGroup(group.getMvcId());</span>
                }
<span class="nc" id="L275">            } catch (Exception x) {</span>
<span class="nc" id="L276">                LOG.warn(&quot;Could not destroy group [{}] of type {}&quot;, mvcId, configuration.getMvcType(), sanitize(x));</span>
<span class="nc" id="L277">            }</span>
<span class="nc" id="L278">        }</span>
<span class="nc" id="L279">    }</span>

    @SuppressWarnings(&quot;unchecked&quot;)
    protected void withMVCGroup(@Nonnull MVCGroupConfiguration configuration, @Nullable String mvcId, @Nonnull Map&lt;String, Object&gt; args, @Nonnull MVCGroupFunction handler) {
<span class="nc" id="L283">        MVCGroup group = null;</span>
        try {
<span class="nc" id="L285">            group = createMVCGroup(configuration, mvcId, args);</span>
<span class="nc" id="L286">            handler.apply(group);</span>
        } finally {
<span class="nc" id="L288">            try {</span>
<span class="nc bnc" id="L289" title="All 4 branches missed.">                if (group != null) {</span>
<span class="nc" id="L290">                    destroyMVCGroup(group.getMvcId());</span>
                }
<span class="nc" id="L292">            } catch (Exception x) {</span>
<span class="nc" id="L293">                LOG.warn(&quot;Could not destroy group [{}] of type {}&quot;, mvcId, configuration.getMvcType(), sanitize(x));</span>
<span class="nc" id="L294">            }</span>
<span class="nc" id="L295">        }</span>
<span class="nc" id="L296">    }</span>

    @Nonnull
    protected abstract MVCGroup createMVCGroup(@Nonnull MVCGroupConfiguration configuration, @Nullable String mvcId, @Nonnull Map&lt;String, Object&gt; args);

    protected abstract void doInitialize(@Nonnull Map&lt;String, MVCGroupConfiguration&gt; configurations);

    @Nonnull
    @Override
    public MVCGroup createMVCGroup(@Nonnull String mvcType) {
<span class="nc" id="L306">        return createMVCGroup(findConfiguration(mvcType), null, Collections.&lt;String, Object&gt;emptyMap());</span>
    }

    @Nonnull
    @Override
    public MVCGroup createMVCGroup(@Nonnull String mvcType, @Nonnull String mvcId) {
<span class="nc" id="L312">        return createMVCGroup(findConfiguration(mvcType), mvcId, Collections.&lt;String, Object&gt;emptyMap());</span>
    }

    @Nonnull
    @Override
    public MVCGroup createMVCGroup(@Nonnull Map&lt;String, Object&gt; args, @Nonnull String mvcType) {
<span class="nc" id="L318">        return createMVCGroup(findConfiguration(mvcType), null, args);</span>
    }

    @Nonnull
    @Override
    public MVCGroup createMVCGroup(@Nonnull String mvcType, @Nonnull Map&lt;String, Object&gt; args) {
<span class="nc" id="L324">        return createMVCGroup(findConfiguration(mvcType), null, args);</span>
    }

    @Nonnull
    @Override
    public MVCGroup createMVCGroup(@Nonnull Map&lt;String, Object&gt; args, @Nonnull String mvcType, @Nonnull String mvcId) {
<span class="nc" id="L330">        return createMVCGroup(findConfiguration(mvcType), mvcId, args);</span>
    }

    @Nonnull
    @Override
    public MVCGroup createMVCGroup(@Nonnull String mvcType, @Nonnull String mvcId, @Nonnull Map&lt;String, Object&gt; args) {
<span class="nc" id="L336">        return createMVCGroup(findConfiguration(mvcType), mvcId, args);</span>
    }

    @Nonnull
    @Override
    public List&lt;? extends GriffonMvcArtifact&gt; createMVC(@Nonnull String mvcType) {
<span class="nc" id="L342">        return createMVC(findConfiguration(mvcType), null, Collections.&lt;String, Object&gt;emptyMap());</span>
    }

    @Nonnull
    @Override
    public List&lt;? extends GriffonMvcArtifact&gt; createMVC(@Nonnull Map&lt;String, Object&gt; args, @Nonnull String mvcType) {
<span class="nc" id="L348">        return createMVC(findConfiguration(mvcType), null, args);</span>
    }

    @Nonnull
    @Override
    public List&lt;? extends GriffonMvcArtifact&gt; createMVC(@Nonnull String mvcType, @Nonnull Map&lt;String, Object&gt; args) {
<span class="nc" id="L354">        return createMVC(findConfiguration(mvcType), null, args);</span>
    }

    @Nonnull
    @Override
    public List&lt;? extends GriffonMvcArtifact&gt; createMVC(@Nonnull String mvcType, @Nonnull String mvcId) {
<span class="nc" id="L360">        return createMVC(findConfiguration(mvcType), mvcId, Collections.&lt;String, Object&gt;emptyMap());</span>
    }

    @Nonnull
    @Override
    public List&lt;? extends GriffonMvcArtifact&gt; createMVC(@Nonnull Map&lt;String, Object&gt; args, @Nonnull String mvcType, @Nonnull String mvcId) {
<span class="nc" id="L366">        return createMVC(findConfiguration(mvcType), mvcId, args);</span>
    }

    @Nonnull
    @Override
    public List&lt;? extends GriffonMvcArtifact&gt; createMVC(@Nonnull String mvcType, @Nonnull String mvcId, @Nonnull Map&lt;String, Object&gt; args) {
<span class="nc" id="L372">        return createMVC(findConfiguration(mvcType), mvcId, args);</span>
    }

    @Override
    public &lt;M extends GriffonModel, V extends GriffonView, C extends GriffonController&gt; void withMVC(@Nonnull String mvcType, @Nonnull MVCFunction&lt;M, V, C&gt; handler) {
<span class="nc" id="L377">        withMVCGroup(findConfiguration(mvcType), null, Collections.&lt;String, Object&gt;emptyMap(), handler);</span>
<span class="nc" id="L378">    }</span>

    @Override
    public &lt;M extends GriffonModel, V extends GriffonView, C extends GriffonController&gt; void withMVC(@Nonnull String mvcType, @Nonnull String mvcId, @Nonnull MVCFunction&lt;M, V, C&gt; handler) {
<span class="nc" id="L382">        withMVCGroup(findConfiguration(mvcType), mvcId, Collections.&lt;String, Object&gt;emptyMap(), handler);</span>
<span class="nc" id="L383">    }</span>

    @Override
    public &lt;M extends GriffonModel, V extends GriffonView, C extends GriffonController&gt; void withMVC(@Nonnull String mvcType, @Nonnull String mvcId, @Nonnull Map&lt;String, Object&gt; args, @Nonnull MVCFunction&lt;M, V, C&gt; handler) {
<span class="nc" id="L387">        withMVCGroup(findConfiguration(mvcType), mvcId, args, handler);</span>
<span class="nc" id="L388">    }</span>

    @Override
    public &lt;M extends GriffonModel, V extends GriffonView, C extends GriffonController&gt; void withMVC(@Nonnull Map&lt;String, Object&gt; args, @Nonnull String mvcType, @Nonnull String mvcId, @Nonnull MVCFunction&lt;M, V, C&gt; handler) {
<span class="nc" id="L392">        withMVCGroup(findConfiguration(mvcType), mvcId, args, handler);</span>
<span class="nc" id="L393">    }</span>

    @Override
    public &lt;M extends GriffonModel, V extends GriffonView, C extends GriffonController&gt; void withMVC(@Nonnull String mvcType, @Nonnull Map&lt;String, Object&gt; args, @Nonnull MVCFunction&lt;M, V, C&gt; handler) {
<span class="nc" id="L397">        withMVCGroup(findConfiguration(mvcType), null, args, handler);</span>
<span class="nc" id="L398">    }</span>

    @Override
    public &lt;M extends GriffonModel, V extends GriffonView, C extends GriffonController&gt; void withMVC(@Nonnull Map&lt;String, Object&gt; args, @Nonnull String mvcType, @Nonnull MVCFunction&lt;M, V, C&gt; handler) {
<span class="nc" id="L402">        withMVCGroup(findConfiguration(mvcType), null, args, handler);</span>
<span class="nc" id="L403">    }</span>

    @Override
    public void withMVCGroup(@Nonnull String mvcType, @Nonnull MVCGroupFunction handler) {
<span class="nc" id="L407">        withMVCGroup(findConfiguration(mvcType), null, Collections.&lt;String, Object&gt;emptyMap(), handler);</span>
<span class="nc" id="L408">    }</span>

    @Override
    public void withMVCGroup(@Nonnull String mvcType, @Nonnull String mvcId, @Nonnull MVCGroupFunction handler) {
<span class="nc" id="L412">        withMVCGroup(findConfiguration(mvcType), mvcId, Collections.&lt;String, Object&gt;emptyMap(), handler);</span>
<span class="nc" id="L413">    }</span>

    @Override
    public void withMVCGroup(@Nonnull String mvcType, @Nonnull String mvcId, @Nonnull Map&lt;String, Object&gt; args, @Nonnull MVCGroupFunction handler) {
<span class="nc" id="L417">        withMVCGroup(findConfiguration(mvcType), mvcId, args, handler);</span>
<span class="nc" id="L418">    }</span>

    @Override
    public void withMVCGroup(@Nonnull Map&lt;String, Object&gt; args, @Nonnull String mvcType, @Nonnull String mvcId, @Nonnull MVCGroupFunction handler) {
<span class="nc" id="L422">        withMVCGroup(findConfiguration(mvcType), mvcId, args, handler);</span>
<span class="nc" id="L423">    }</span>

    @Override
    public void withMVCGroup(@Nonnull String mvcType, @Nonnull Map&lt;String, Object&gt; args, @Nonnull MVCGroupFunction handler) {
<span class="nc" id="L427">        withMVCGroup(findConfiguration(mvcType), null, args, handler);</span>
<span class="nc" id="L428">    }</span>

    @Override
    public void withMVCGroup(@Nonnull Map&lt;String, Object&gt; args, @Nonnull String mvcType, @Nonnull MVCGroupFunction handler) {
<span class="nc" id="L432">        withMVCGroup(findConfiguration(mvcType), null, args, handler);</span>
<span class="nc" id="L433">    }</span>

    @Nonnull
    @Override
    public &lt;C extends GriffonController&gt; C getController(@Nonnull String name, @Nonnull Class&lt;C&gt; type) throws ArtifactNotFoundException {
<span class="nc" id="L438">        requireNonBlank(name, ERROR_NAME_BLANK);</span>
<span class="nc" id="L439">        requireNonNull(type, ERROR_TYPE_NULL);</span>
<span class="nc" id="L440">        GriffonController controller = getControllers().get(name);</span>
<span class="nc bnc" id="L441" title="All 2 branches missed.">        if (controller != null) {</span>
<span class="nc" id="L442">            return type.cast(controller);</span>
        }
<span class="nc" id="L444">        throw new ArtifactNotFoundException(type, name);</span>
    }

    @Nonnull
    @Override
    public &lt;M extends GriffonModel&gt; M getModel(@Nonnull String name, @Nonnull Class&lt;M&gt; type) throws ArtifactNotFoundException {
<span class="nc" id="L450">        requireNonBlank(name, ERROR_NAME_BLANK);</span>
<span class="nc" id="L451">        requireNonNull(type, ERROR_TYPE_NULL);</span>
<span class="nc" id="L452">        GriffonModel model = getModels().get(name);</span>
<span class="nc bnc" id="L453" title="All 2 branches missed.">        if (model != null) {</span>
<span class="nc" id="L454">            return type.cast(model);</span>
        }
<span class="nc" id="L456">        throw new ArtifactNotFoundException(type, name);</span>
    }

    @Nonnull
    @Override
    public &lt;V extends GriffonView&gt; V getView(@Nonnull String name, @Nonnull Class&lt;V&gt; type) throws ArtifactNotFoundException {
<span class="nc" id="L462">        requireNonBlank(name, ERROR_NAME_BLANK);</span>
<span class="nc" id="L463">        requireNonNull(type, ERROR_TYPE_NULL);</span>
<span class="nc" id="L464">        GriffonView view = getViews().get(name);</span>
<span class="nc bnc" id="L465" title="All 2 branches missed.">        if (view != null) {</span>
<span class="nc" id="L466">            return type.cast(view);</span>
        }
<span class="nc" id="L468">        throw new ArtifactNotFoundException(type, name);</span>
    }

    @Nullable
    @Override
    public &lt;C extends GriffonController&gt; C findController(@Nonnull String name, @Nonnull Class&lt;C&gt; type) {
        try {
<span class="nc" id="L475">            return getController(name, type);</span>
<span class="nc" id="L476">        } catch (ArtifactNotFoundException anfe) {</span>
<span class="nc" id="L477">            return null;</span>
        }
    }

    @Nullable
    @Override
    public &lt;M extends GriffonModel&gt; M findModel(@Nonnull String name, @Nonnull Class&lt;M&gt; type) {
        try {
<span class="nc" id="L485">            return getModel(name, type);</span>
<span class="nc" id="L486">        } catch (ArtifactNotFoundException anfe) {</span>
<span class="nc" id="L487">            return null;</span>
        }
    }

    @Nullable
    @Override
    public &lt;V extends GriffonView&gt; V findView(@Nonnull String name, @Nonnull Class&lt;V&gt; type) {
        try {
<span class="nc" id="L495">            return getView(name, type);</span>
<span class="nc" id="L496">        } catch (ArtifactNotFoundException anfe) {</span>
<span class="nc" id="L497">            return null;</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>